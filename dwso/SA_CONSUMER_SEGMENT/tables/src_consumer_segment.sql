CREATE TABLE IF NOT EXISTS sa_consumer_segment.src_consumer_segment AS 
		(
		SELECT order_srcid ,
				order_priority,
				order_date,
				ship_date,
				shipment_srcid,
				ship_mode,
				shipment_type,
				customer_srcid,
				customer_name,
				customer_dob,
				customer_full_age,
				customer_gender,
				customer_email,
				customer_phone,
				customer_address_id,
				customer_address,
				customer_city_id,
				customer_city,
				customer_country_id,
				customer_country,
				customer_region_id,
				customer_region,
				supplier_srcid,
				supplier_name,
				manager_srcid,
				supplier_manager_name,
				supplier_manager_phone,
				supplier_manager_email,
				supplier_address_id,
				supplier_address,
				supplier_city_id,
				supplier_city,
				supplier_country_id,
				supplier_country,
				supplier_region_id,
				supplier_region,
				supplier_status,
				market_srcid,
				market_desc,
				market_address_id,
				market_address,
				market_city_id,
				market_city,
				market_country_id,
				market_country,
				market_region_id,
				market_region,
				employee_srcid,
				employee_name,
				employee_surname,
				employee_full_name,
				employee_dob,
				employee_email,
				employee_phone,
				employee_position,
				product_srcid,
				product_desc,
				product_category_id,
				product_category_desc,
				product_group_id,
				product_group_desc,
				product_price ,
				sales_amount,
				quantity,
				discount,
				profit,
				shipping_cost,
				product_status,
				loyal_program_srcid,
				loyal_program_desc,
				loyal_discount	
		FROM sa_consumer_segment.ext_consumer_segment
		);
ALTER TABLE sa_consumer_segment.src_consumer_segment ADD COLUMN IF NOT EXISTS insert_dt TIMESTAMP DEFAULT current_timestamp ; 
ALTER TABLE sa_consumer_segment.src_consumer_segment ADD COLUMN IF NOT EXISTS update_dt TIMESTAMP DEFAULT current_timestamp ;
ALTER TABLE sa_consumer_segment.src_consumer_segment ADD COLUMN IF NOT EXISTS is_processed BOOLEAN NOT NULL DEFAULT 'N';
COMMIT;
